# Práctica 1

## Tarea 3

Enunciado de la Tarea 3: <https://ipm-fic.github.io/assignment--202122-01/tarea_3/>

**Objetivo**: implementar pruebas automatizadas _end-to-end_ (_e2e_) de la aplicación.


## Herramientas

Librería recomendada: [pytest](https://docs.pytest.org/en/6.2.x/)

Para poder utilizar `pytest`, hay que instalarla con el siguiente comando:
```bash
pip3 install pytest
```

Las pruebas automatizadas se harán utilizando el API **AT-SPI**.

En lugar de utilizar esta API directamente, se puede utilizar una librería con un API de más alto nivel.

Generalmente, la que se utiliza en la asignatura recibe el nombre de `ipm_e2e`. En el siguiente enlace se puede encontrar una versión parcheada compatible tanto con Python 3.9 como con Python 3.8: 

- <https://github.com/m-gende/ipm_e2e>

Para instalarla, solo es necesario hacer un `clone` del respositorio, y ejecutar el comando típico de instalación de `pip3`, indicando la carpeta con el código de la librería:

```bash
git clone git@github.com:m-gende/ipm_e2e.git
pip3 install ipm_e2e/
```

En el segundo de estos comandos es importante poner la barra final de `ipm_e2e/`, para indicar que se quiere hacer la instalación desde una carpeta del sistema, y no desde los repositorios de Python.


## Código de ejemplo

En la carpeta `ejemplo-atspi` del repositorio se adjuntan 2 versiones del código de una sencilla aplicación y de sus pruebas, implementadas mediante la mencionada librería `ipm_e2e`.

### Instrucciones de ejecución

Ejecución de la aplicación:
```bash
./example_atspi.py
./example_atspi2.py
```

Ejecución de las pruebas:
```bash
python3 example_test.py ./example_atspi.py
python3 example_test.py ./example_atspi2.py
```


## Requisitos

* Todo el código de pruebas que elaboréis ha de poder ser ejecutado mediante un único _bash script_ ejecutable de nombre `./run-tests.sh`. Así, bastará con poner el siguiente comando
  ```bash
  ./run-tests.sh
  ```
  para lanzar todas las pruebas.

* Cada una de las pruebas ha de ser independiente, por lo que ha de dejar el sistema en el mismo estado en el que se econtraba antes de la prueba. Para ello, es necesario que cada una de estas pruebas arranque y termine la aplicación. Esto garantiza que no se dan situaciones de dependencia no deseadas.

* Una prueba ha de ser válida tanto para la presente versión de la aplicación como para versiones futuras (dentro de un límite razonable). Por ello, hay que evitar que la implementación de las pruebas dependa directamente de la implementación concreta de la interfaz. Un ejemplo típico de esta dependencia es la inclusión de referencias a _widgets_ «padres» o «hijos». En general, este tipo de referencias se consideran incorrectas porque dependen de la configuración concreta del árbol de _widgets_, y esta suele variar a lo largo del tiempo.

